<?xml version="1.0"?>
<launch>
    <arg name="namespace" default="tello"/>

    <group ns="$(arg namespace)">
        <!-- frame setting-->
        <node pkg="tf" type="static_transform_publisher" name="map_to_$(arg namespace)" output="screen"
              args="0 0 0 0 0 0 map $(arg namespace) 10"/>

        <!-- tello driver setting-->
        <arg name="tello_ip" default="192.168.11.50"/>
        <arg name="tello_port" default="8889"/>
        <arg name="client_port" default="8890"/>
        <arg name="vid_port" default="6038"/>
        <arg name="conn_port" default="9617"/>
        <arg name="tello_name" default="FD41FA"/>

        <node pkg="tello_driver" name="tello" type="tello_driver_node.py" output="screen">
            <param name="tello_ip" value="$(arg tello_ip)"/>
            <param name="tello__port" value="$(arg tello_port)"/>
            <param name="client_port" value="$(arg client_port)"/>
            <param name="vid_port" value="$(arg vid_port)"/>
            <param name="conn_port" value="$(arg conn_port)"/>
            <param name="connect_timeout_sec" value="10.0"/>
            <param name="frame_id" value="$(arg namespace)"/>
        </node>

        <param name="calib_fname" value="$(find tello_driver)/calib_data/$(arg tello_name).yaml"/>
        <node pkg="tello_driver" name="camera_info_publisher" type="yaml_to_camera_info_publisher.py" output="screen"/>

        <!-- image-view -->
        <node name="image_view" pkg="image_view" type="image_view" respawn="false" output="screen">
            <remap from="image" to="/$(arg namespace)/image_raw" />
        </node>

        <!-- ar_track-alvar setting-->
        <arg name="marker_size" default="15" />
        <arg name="max_new_marker_error" default="0.08" />
        <arg name="max_track_error" default="0.2" />
        <arg name="cam_image_topic" default="/$(arg namespace)/image_raw" />
        <arg name="cam_info_topic" default="/$(arg namespace)/camera_info" />
        <arg name="output_frame" default="$(arg namespace)" />

        <node name="ar_track_alvar" pkg="ar_track_alvar" type="individualMarkersNoKinect" respawn="false" output="screen">
            <param name="marker_size"           type="double" value="$(arg marker_size)" />
            <param name="max_new_marker_error"  type="double" value="$(arg max_new_marker_error)" />
            <param name="max_track_error"       type="double" value="$(arg max_track_error)" />
            <param name="output_frame"          type="string" value="$(arg output_frame)" />
            <remap from="camera_image"  to="$(arg cam_image_topic)" />
            <remap from="camera_info"   to="$(arg cam_info_topic)" />
        </node>
    </group>
</launch>
